namespace("MySpace.UI.Pages.SiteBlogs");MySpace.UI.Pages.SiteBlogs.Wire=function(m){var g={en:MySpaceRes.International.English,sq:MySpaceRes.International.Albanian,ar:MySpaceRes.International.Arabic,bg:MySpaceRes.International.Bulgarian,ca:MySpaceRes.International.Catalan,zh:MySpaceRes.International.Chinese,hr:MySpaceRes.International.Croatian,cs:MySpaceRes.International.Czech,da:MySpaceRes.International.Danish,nl:MySpaceRes.International.Dutch1,et:MySpaceRes.International.Estonian,tl:MySpaceRes.International.Filipino,fi:MySpaceRes.International.Finnish,fr:MySpaceRes.International.French1,gl:MySpaceRes.International.Galician,de:MySpaceRes.International.German1,el:MySpaceRes.International.Greek,iw:MySpaceRes.International.Hebrew,hi:MySpaceRes.International.Hindi,hu:MySpaceRes.International.Hungarian,id:MySpaceRes.International.Indonesian,it:MySpaceRes.International.Italian1,ja:MySpaceRes.International.Japanese,ko:MySpaceRes.International.Korean,lv:MySpaceRes.International.Latvian,lt:MySpaceRes.International.Lithuanian,mt:MySpaceRes.International.Maltese,no:MySpaceRes.International.Norwegian,pl:MySpaceRes.International.Polish,pt:MySpaceRes.International.Portuguese,ro:MySpaceRes.International.Romanian,ru:MySpaceRes.International.Russian,sr:MySpaceRes.International.Serbian,sk:MySpaceRes.International.Slovak,sl:MySpaceRes.International.Slovenian,es:MySpaceRes.International.Spanish,sv:MySpaceRes.International.Swedish,th:MySpaceRes.International.Thai,tr:MySpaceRes.International.Turkish,uk:MySpaceRes.International.Ukrainian,vi:MySpaceRes.International.Vietnamese};var b=null;var h=$q(".blogListModule",null,true);if(h==null||typeof(h)=="undefined"){h=$q(".SingleBlogModule",null,true)}if(h==null||typeof(h)=="undefined"){return}var a=$q(".footerBlog",h);var c=function(u,i){var y=document.createElement("ul");var v=document.createElement("li");var w=document.createElement("img");w.setAttribute("src",MySpace.StaticContentBase+"/modules/profiles/static/img/v3/sites/blogs/google_logo.png");w.setAttribute("alt","Google Translate");v.appendChild(w);y.appendChild(v);for(p in g){var x=document.createElement("li");x.innerHTML=g[p];y.appendChild(x);$addHandler(x,"click",Function.createDelegate(this,Function.createCallback(l,{blogId:i,gLang:p})))}u.appendChild(y)};var l=function(w,i){var v=i.blogId;var x=i.gLang;var u=w.rawEvent.currentTarget;while(u.className!=null&&u.className!="blogEntry"){u=u.parentNode}r(v,x,$q("time.post-date",u,true));r(v,x,$q("p.mood",u,true));r(v,x,$q("h4.post-title",u,true));r(v,x,$q(".post-body",u,true))};var r=function(i,u,v){if(v!=null&&v!="undefined"){t(i,v,v,u)}};var t=function(i,v,x,u){if(v!=null&&x!=null){var w=null;w=v.innerHTML;x.innerHTML="";e(encodeURIComponent(w),x,u,900)}};var e=function(A,i,x,w){var v=A.toLowerCase().indexOf("%3Cobject");var u=A.toLowerCase().indexOf("%3C%2Fobject%3E");if(v>-1&&u>-1){e(A.substring(0,v),i,x,w);var z=i;z.innerHTML+=A.substring(v,u+15)+"%3Cbr%3E";e(A.substring(u+15),i,x,w);return}if(A.length<w+25){google.language.translate(decodeURIComponent(A),"",x,function(B){var C=i;if(B.translation){C.innerHTML+=B.translation}})}else{var y=A.substring(0,w).lastIndexOf("%3C%2F");if(y>-1){y=y+A.substring(y).indexOf("%3E")+3}if(y<=2){y=A.substring(0,w).lastIndexOf("%3C");if(y<=0){y=A.substring(0,w).lastIndexOf(".")+1;if(y<=0){y=A.substring(0,w).lastIndexOf("%3F")+3;if(y<=2){y=A.substring(0,w).lastIndexOf("!")+1;if(y<=0){y=A.substring(0,w).lastIndexOf("%2C")+3;if(y<=2){y=A.substring(0,w).lastIndexOf("%20")+3;if(y<=2){y=w}}}}}}}e(A.substring(0,y),i,x,w);e(A.substring(y),i,x,w)}};var o=function(v,i){v.preventDefault();v.stopPropagation();var u=i.blogId;q(u)};var q=function(u){if(u==null||typeof(u)=="undefined"){return}var i=BlogEntry(u);var v=d(u,i);if(v==null||typeof(v)=="undefined"){return}if(v[0].style.display==""||v[0].style.display=="none"){v[0].style.display="block"}else{v[0].style.display="none"}};var d=function(v,i){var u=FooterTranslate(v,i);if(u==null||typeof(u)=="undefined"){return null}return $q("ul.googleTranslateLayer",u)};var k=function(v,u){_commentPopup=null;var i=Sys.Serialization.JavaScriptSerializer.deserialize(u.data)};var j=function(u,i){MySpace.UI.addQuickPostScript(function(){if(!b){b=$create(MySpace.UI.QuickPostPopup,{webServiceUrl:"/Modules/BlogV2/Services/CommentWS.asmx",webServiceParams:{blogId:i.blogId,commentId:0,friendId:i.friendId}});b.add_success(this.onCommentPostedPopupAjax)}b.show()})};for(var f=0;f<a.length;f++){if(a[f].wired){continue}a[f].wired=true;var n=a[f].getAttribute("data-blogid");var s=$q("li.translate",a[f],true);if(s){c(s,n)}}(function(i){var u=i(".blogListModule:first");u.find(".removeBlog").each(function(){i(this).click(function(){var x=i(this).attr("blogId");var y={};y[MySpaceRes.BlogPage.Cancel]=function(){return false};y[MySpaceRes.BlogPage.Remove]=function(){var z=String.format("source=BlogList&blogId={0}",x);MySpace.UI.Pages.Data.request("RemoveBlog.ashx",null,function(E){try{var B=E.get_responseData();var D=jQuery.parseJSON(B.toString());var A=u.find(".moduleBody");A.html(D.content)}catch(C){u.find(".sysMessage").removeClass("hide");u.find(".sysMessage").html(MySpaceRes.BlogPage.ErrorUnspecified)}},z,null)};i("<div>"+MySpaceRes.BlogPage.DoYouReallyRemove+"</div>").dialog({title:MySpaceRes.BlogPage.Remove,buttons:y,buttonClass:{OK:"secondary",Cancel:"noButton"},width:100,height:30})})});var v=i(".SingleBlogModule:first");v.find(".removeBlog").click(function(){var x=i(this).attr("blogId");var y={};y[MySpaceRes.BlogPage.Cancel]=function(){return false};y[MySpaceRes.BlogPage.Remove]=function(){var z=String.format("source=SingleBlog&blogId={0}",x);MySpace.UI.Pages.Data.request("RemoveBlog.ashx",null,function(D){try{var A=D.get_responseData();var C=jQuery.parseJSON(A.toString());i.comm.send("location.href",C.content)}catch(B){v.find(".sysMessage").removeClass("hide");v.find(".sysMessage").html(MySpaceRes.BlogPage.ErrorUnspecified)}},z,null)};i("<div>"+MySpaceRes.BlogPage.DoYouReallyRemove+"</div>").dialog({title:MySpaceRes.BlogPage.Remove,buttons:y,buttonClass:{OK:"secondary",Cancel:"noButton"},width:100,height:30})});var w=u.find(".followLabel");if(!w.length){w=v.find(".followLabel")}w.click(function(){if(w.hasClass("follow")){MySpace.UI.Pages.Data.request("FollowBlog.ashx",this,function(y){var x=y.get_responseData();w.removeClass("follow");w.addClass("unfollow");w.html(x)},null,null)}else{if(w.hasClass("unfollow")){MySpace.UI.Pages.Data.request("UnfollowBlog.ashx",this,function(y){var x=y.get_responseData();w.removeClass("unfollow");w.addClass("follow");w.html(x)},null,null)}}})})(jQuery);(function(i){i(".blogListModule .commentlink").each(function(){i(this).attr("href",i(".post-title a",i(this).closest(".blogEntry")).attr("href"))});i(".SingleBlogModule .commentlink").each(function(){i(this).removeAttr("href")})})(jQuery)};var originalText=null;function gTranslate(c,f,a){if(originalText==null){originalText=[]}var b=document.getElementById(c);var e=document.getElementById(f);if(b!=null&&e!=null){var d=null;if(c==f){if(originalText[c]==null){originalText[c]=b.innerHTML;d=b.innerHTML}else{d=originalText[c]}}else{d=b.innerHTML}e.innerHTML="";doTranslate(encodeURIComponent(d),f,a,900)}}function doTranslate(h,a,e,d){var c=h.toLowerCase().indexOf("%3Cobject");var b=h.toLowerCase().indexOf("%3C%2Fobject%3E");if(c>-1&&b>-1){doTranslate(h.substring(0,c),a,e,d);var g=document.getElementById(a);g.innerHTML+=h.substring(c,b+15)+"%3Cbr%3E";doTranslate(h.substring(b+15),a,e,d);return}if(h.length<d+25){google.language.translate(decodeURIComponent(h),"",e,function(i){var j=document.getElementById(a);if(i.translation){j.innerHTML+=i.translation}})}else{var f=h.substring(0,d).lastIndexOf("%3C%2F");if(f>-1){f=f+h.substring(f).indexOf("%3E")+3}if(f<=2){f=h.substring(0,d).lastIndexOf("%3C");if(f<=0){f=h.substring(0,d).lastIndexOf(".")+1;if(f<=0){f=h.substring(0,d).lastIndexOf("%3F")+3;if(f<=2){f=h.substring(0,d).lastIndexOf("!")+1;if(f<=0){f=h.substring(0,d).lastIndexOf("%2C")+3;if(f<=2){f=h.substring(0,d).lastIndexOf("%20")+3;if(f<=2){f=d}}}}}}}doTranslate(h.substring(0,f),a,e,d);doTranslate(h.substring(f),a,e,d)}}function translateBlog(d,c){showLanguageOptions(c);gTranslate("pBlogSubject_"+c,"pBlogSubject_"+c,d);gTranslate("pBlogBody_"+c,"pBlogBody_"+c,d);var a=document.getElementsByTagName("DIV");for(var b=0;b<a.length;b++){if(a[b].id.indexOf("CommentDiv_")>-1){gTranslate(a[b].id,a[b].id,d)}}}function showLanguageOptions(a){var b=document.getElementById("languageOptions_"+a);if(b!=null){if(b.style.display=="block"){b.style.display="none"}else{b.style.display="block"}}}function backToOriginal(){jQuery.comm.send("location.href",window.location.href)}function showKudoOptions(a){var b=document.getElementById("Panel"+a);if(b!=null){b.style.display="block"}}function giveKudos(c,a,f,b){if(f>0&&f<=2){Sys.Net.WebServiceProxy.invoke("/Modules/BlogV2/Services/BlogWS.asmx","addKudos",false,{friendId:c,blogId:a,kudos:f,divId:b},OnSucceeded,null,null,3000)}var e=document.getElementById("Panel"+b);if(e!=null){e.style.display="none"}var d=document.getElementById("KudoIcon");if(d!=null){d.style.display="block";if(navigator.userAgent.indexOf("MSIE")>-1){d.style.textAlign="center"}else{d.style.marginLeft="32px"}}}function OnFailed(a){alert("Failed: "+a.get_message())}function OnSucceeded(f,b){var e=Sys.Serialization.JavaScriptSerializer.deserialize(f);var c=document.getElementById("KudoCount"+e.divId);if(c!=null){if(c.innerHTML.indexOf(" ")>-1){c.innerHTML=parseInt(c.innerHTML)+parseInt(e.kudos)+" "+e.strKudos}else{c.innerHTML=parseInt(c.innerHTML)+parseInt(e.kudos)}}var a=document.getElementById("KudoSideList");if(a!=null){a.style.display="block"}var d=document.getElementById("NewlyAddedKudos");if(d!=null){d.innerHTML=e.currentUserUrl+"("+e.kudos+")"}}function onCommentPostedPopupAjax2(b,a){postPopupHandler(a.data)}function synCommentCount(h){var b=document.getElementsByTagName("DIV");for(var c=0;c<b.length;c++){if(b[c].className=="pagingLeft"){var g=b[c].innerHTML;var d=g.substring(0,g.length-2).lastIndexOf(" ");var e=g.indexOf("-");var f=g.substring(e).indexOf(" ");var j=parseInt(g.substring(e,e+f));if(j%50!=0){b[c].innerHTML=g.substring(0,e+1)+h+g.substring(e+f,d+1)+h}else{b[c].innerHTML=g.substring(0,d)+" "+h}}}}function postPopupHandler(e){if(e.indexOf("CommentSubmittedForApproval")==-1&&e.length>0){var f=Sys.Serialization.JavaScriptSerializer.deserialize(e);var c=document.getElementById("cmtCount_"+f.BlogID);if(c!=null){var k=parseInt(c.innerHTML)+1;c.innerHTML=k+" "+f.StrComments;synCommentCount(k)}var j=parseInt(f.ParentCommentID);var h=document.getElementById("NewDiv_"+j);if(h!=null){if(j==0){h.innerHTML+=f.Content}else{h.innerHTML=f.Content+h.innerHTML}}var b=document.getElementsByTagName("A");for(var g=0;g<b.length;g++){if(b[g].id!=null){if(b[g].id.indexOf("addReplyLnk_")>-1){var d=b[g].id.substring(12);$addHandler($get(b[g].id),"click",Function.createPartial(null,openReplyPopup,d))}}}}}function invokeWebIM(a){if(MySpace&&MySpace.ClientContext&&a){MySpace.ClientContext.ProfileFriend={id:a.UserID,displayName:a.DisplayName,img_s:a.IMG_S,img_m:a.IMG_M,isOnline:a.IsOnline};MySpace.invokeWebIMWrapper(MySpace.ClientContext.ProfileFriend)}}MySpace_UI_Blogs={markCommentAsSpam:function(a,c,b,e){var d=document.getElementById(e);d.value=c+"|"+a+"|"+b;document.getElementById("aspnetForm").submit()}};